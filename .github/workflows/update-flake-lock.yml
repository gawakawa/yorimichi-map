name: "Update Flake Lock"

on:
  workflow_dispatch: # Allow manual trigger
  schedule:
    - cron: "0 15 * * 5" # Run every Saturday at 00:00 JST (Friday 15:00 UTC)

permissions:
  contents: write
  pull-requests: write

jobs:
  update-flake-lock:
    strategy:
      matrix:
        directory: [frontend, backend, terraform]
    uses: gawakawa/.github/.github/workflows/update-flake-lock.yml@main
    with:
      auto-merge: true
      path-to-flake-dir: ${{ matrix.directory }}
      branch: update-flake-lock-${{ matrix.directory }}
    secrets:
      GH_TOKEN: ${{ secrets.GH_TOKEN }}
